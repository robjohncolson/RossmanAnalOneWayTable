{
  "fileName": "Analyzing One-way Tables.html",
  "appInfo": {
    "appName": "Analyzing One-way Tables",
    "version": "42a (mentioned in g_about variable)",
    "authors": "Beth and Frank Chance",
    "collection": "Rossman/Chance Applet Collection",
    "copyright": "Copyright (c) 2012-2020 Beth and Frank Chance",
    "lastModified": "Detected via document.lastModified, displayed in footer.",
    "description": "A web-based interactive applet designed for educational purposes to analyze one-way frequency tables. It allows users to input categorical data (either raw or as counts), visualize the observed distribution, calculate statistics (Chi-squared, Mean Absolute Deviation (MAD), Max-Min proportion difference, Tallies), perform simulation-based inference (random sampling/shuffling under a null hypothesis), visualize the resulting sampling distribution via a histogram, and compare results to theoretical distributions (Chi-squared, Normal).",
    "technologiesUsed": [
      "HTML",
      "CSS",
      "JavaScript",
      "jQuery",
      "jQuery UI",
      "Plotly.js (for pie chart)",
      "HTML5 Canvas API (for main plots)"
    ]
  },
  "structure": {
    "head": {
      "description": "Contains metadata, links to external CSS/JS libraries (jQuery, jQuery UI, Plotly), internal CSS, and the main JavaScript code block.",
      "scripts": [
        {"src": "./Analyzing One-way Tables_files/jquery-1.9.1.js.download", "purpose": "jQuery library"},
        {"src": "./Analyzing One-way Tables_files/jquery-ui.js.download", "purpose": "jQuery UI library"},
        {"src": "./Analyzing One-way Tables_files/plotly-latest.min.js.download", "purpose": "Plotly charting library"},
        {"src": "./Analyzing One-way Tables_files/errors.js.download", "purpose": "Likely custom error handling/display (showAlert, hideAlert)"},
        {"inline": "Contains main application logic, variable definitions, functions."}
      ],
      "styles": [
        {"href": "./Analyzing One-way Tables_files/jquery-ui.css", "purpose": "jQuery UI styling"},
        {"href": "./Analyzing One-way Tables_files/rcapplets.css", "purpose": "Rossman/Chance applet specific styling"},
        {"inline": "#plotly.js-style-global", "purpose": "Global styles potentially added by Plotly"}
      ]
    },
    "body": {
      "description": "Contains the user interface elements, structured using tables. Includes input areas, buttons, checkboxes, dropdowns, canvases for plots, and areas for displaying results and statistics.",
      "onload": "pageSetup()",
      "majorSections": [
        {"id": "pageTitle", "purpose": "Applet Collection Title Bar"},
        {"id": "appletTitle", "purpose": "Specific Applet Title"},
        {"id": "alert", "purpose": "Hidden div for displaying alert messages"},
        {"tag": "table (main layout)", "purpose": "Organizes UI into rows and columns"},
        {"section": "Data Input", "elements": ["selectData", "dataText", "btnUseData", "btnUseTable", "btnClearData"], "purpose": "Allows user to select sample data, paste data/table, and trigger processing."},
        {"section": "Sample Data Visualization", "elements": ["plotTitle", "shufflePlot"], "purpose": "Displays a bar chart of the observed/input data distribution."},
        {"section": "Simulation/Sampling Setup", "elements": ["hypProbText", "setProbs", "pieDiv", "showAltShuffleOptions", "altProbText", "showShuffleOptions", "numberOfShuffles", "ShuffleButton", "shuffleShowCards", "shuffleShowTable", "shuffleShowPlot"], "purpose": "Controls for setting null/alternative hypotheses, initiating sampling, and choosing how to view the most recent sample."},
        {"section": "Most Recent Sample Visualization", "elements": ["shuffleTitle", "simSamplePlot", "shuffledDataTextDiv", "simCardAnimation"], "purpose": "Displays the results of the latest simulation sample (plot, data table, or animation)."},
        {"section": "Sampling Distribution Visualization", "elements": ["scenario2", "cellNumberofShufflesTotal", "histogram", "showGhost", "cellShuffleCountSamples", "countOperator", "countInput", "t_countButton", "countSamplesOutput", "countSamplesNotes", "cellTheoPvalue", "overlayF", "cellTheoPvalueZ", "overlayZ", "cellTheoPvalueOutput"], "purpose": "Displays the histogram of statistics from multiple samples, allows counting samples beyond a threshold, and optionally overlays theoretical distributions."},
        {"section": "Observed Data Table", "elements": ["cellShowTable", "showTable", "TableText"], "purpose": "Displays the frequency table for the observed data."},
        {"section": "Shuffled Data Table", "elements": ["shuffledTableText"], "purpose": "Displays the frequency table for the most recent simulation sample."},
        {"section": "Statistic Selection & Display", "elements": ["statistic", "scenario", "diff", "meanAbsDiff", "chiSquared", "MM", "maxTally", "minTally", "propA", "simDiff", "simMeanAbsDiff", "simChiSquared", "simMM", "simMaxTally", "simMinTally", "simPropA"], "purpose": "Allows selection of the statistic of interest and displays its value for both observed data and the most recent sample."},
        {"section": "Chi-Squared Output", "elements": ["cellShowChisqOutput", "showChisq", "cellChisqOutputTable", "showChidensity", "densityPlot", "shuffledcellChisqOutputTable"], "purpose": "Displays detailed Chi-squared test results (contributions, expected counts, p-value) and optionally a density plot."},
        {"section": "Confidence Intervals", "elements": ["cellCIs", "computeCIs", "cibox", "CIOutput"], "purpose": "Placeholder/potentially incomplete section for confidence intervals."},
        {"section": "Footer/Notes", "elements": ["UserNotes", "UserNotesText", "about", "pageLastModified"], "purpose": "Provides user notes, about information, and copyright/last modified date."}
      ]
    }
  },
  "globalVariables": [
    {"name": "g_about", "type": "String", "purpose": "Version and copyright info."},
    {"name": "g_fillBlue", "type": "String", "purpose": "Hex color code for blue fill."},
    {"name": "g_fillGreen", "type": "String", "purpose": "Hex color code for green fill."},
    {"name": "g_language", "type": "Number", "purpose": "Index for language selection (0=English). Used with t_... arrays."},
    {"name": "g_init", "type": "Boolean", "purpose": "Flag indicating if the applet is just opening."},
    {"name": "g_initDataText", "type": "String", "purpose": "Default raw data shown on load."},
    {"name": "g_initTallyText", "type": "String", "purpose": "Default table data (seems unused in current logic, dataText initialized with g_initDataText)."},
    {"name": "g_countSamples", "type": "Boolean", "purpose": "Flag indicating if samples should be counted against a threshold in the histogram."},
    {"name": "g_inputIsExplanatoryResponse", "type": "Boolean", "purpose": "Indicates column order for raw data (True: Explanatory, Response). Seems unused for one-way table."},
    {"name": "g_lastUseDataText", "type": "String", "purpose": "Stores the last data string processed by useData() for potential revert."},
    {"name": "g_explanatoryTitle", "type": "String", "purpose": "Label for the categorical variable."},
    {"name": "g_responseTitle", "type": "String", "purpose": "Label for the counts/frequency (often just 'Count')."},
    {"name": "g_numLevels", "type": "Number", "purpose": "Number of unique categories (levels) found in the data."},
    {"name": "g_level", "type": "Array<String>", "purpose": "Stores the names of the unique categories."},
    {"name": "g_level_orig", "type": "Array<String>", "purpose": "Stores category names when using table entry, preserving order and allowing empty categories."},
    {"name": "g_explanatory", "type": "Array<String>", "purpose": "Raw category names for each observation (unused after processing)."},
    {"name": "g_numOutcomes", "type": "Number", "purpose": "Number of unique response values (typically 1 for counts in one-way)."},
    {"name": "g_outcome", "type": "Array<String>", "purpose": "Names of unique response values (typically just 'Count')."},
    {"name": "g_response", "type": "Array", "purpose": "Raw response values (unused for one-way counts)."},
    {"name": "g_obsX", "type": "Array<Number>", "purpose": "Integer mapping (index into g_level) for the category of each observation."},
    {"name": "g_obsY", "type": "Array", "purpose": "Integer mapping for response (unused for one-way counts)."},
    {"name": "g_shuffleIndex", "type": "Array<Number>", "purpose": "Stores the category indices for the *current* sample/shuffle. For observed data, it's initially a copy of g_obsX."},
    {"name": "g_noShuffleIndex", "type": "Array<Number>", "purpose": "Stores the category indices for the *original* data. Used as reference."},
    {"name": "g_isShuffled", "type": "Boolean", "purpose": "Flag indicating if the data currently displayed represents a shuffle."},
    {"name": "g_obsSampleX", "type": "Array", "purpose": "Seems related to sampling but possibly redundant or partially used."},
    {"name": "g_obsSampleXorig", "type": "Array", "purpose": "Seems related to sampling but possibly redundant or partially used."},
    {"name": "g_shuffleCount", "type": "Number", "purpose": "Total number of simulation samples generated."},
    {"name": "g_shuffleStats", "type": "Array<Object>", "purpose": "Stores the calculated statistics for each simulation sample. Each object contains keys like 'MAD', 'CHISQ', 'MM', 'shuffleIndex', etc."},
    {"name": "g_shuffleStatsSelectedIndex", "type": "Number | null", "purpose": "Index of the sample currently selected by clicking on the histogram (null if none selected)."},
    {"name": "g_numObs", "type": "Number", "purpose": "Total number of observations in the dataset."},
    {"name": "g_delayMilliseconds", "type": "Number", "purpose": "Delay used in animations."},
    {"name": "g_animationCount", "type": "Number", "purpose": "Counter to prevent overlapping animations."},
    {"name": "g_lastGetShuffleStats", "type": "Object | null", "purpose": "Stores the result of the last call to getShuffleStats(). Used for 'Show Previous' feature."},
    {"name": "g_savedGetShuffleStats", "type": "Object | null", "purpose": "Stores the histogram state before a reset, for the 'Show Previous' feature."},
    {"name": "g_propValues", "type": "Array<Number>", "purpose": "Hypothesized probabilities for each category under the null hypothesis."},
    {"name": "g_altValues", "type": "Array<Number>", "purpose": "Alternative probabilities for each category (used for power simulation if enabled)."},
    {"name": "t_...", "type": "Array<String>", "purpose": "Arrays holding language strings for UI elements (e.g., t_title, t_usedata). Index corresponds to g_language."},
    {"name": "g_showNotes", "type": "Boolean", "purpose": "Flag to control visibility of the user notes section."},
    {"name": "g_tableEntry", "type": "Boolean", "purpose": "Flag indicating if the last data input was processed using 'Use Table'."},
    {"name": "g_tableText", "type": "String", "purpose": "Stores the raw text when using 'Use Table'."},
    {"name": "g_shufflePlot", "type": "Object", "purpose": "Configuration object for the observed data plot canvas ('shufflePlot'). Contains dimensions, titles, scales, border sizes, etc."},
    {"name": "g_simSamplePlot", "type": "Object", "purpose": "Configuration object for the most recent sample plot canvas ('simSamplePlot')."},
    {"name": "g_histogram", "type": "Object", "purpose": "Configuration object for the sampling distribution histogram canvas ('histogram')."},
    {"name": "g_densityPlot", "type": "Object", "purpose": "Configuration object for the theoretical density plot canvas ('densityPlot')."},
    {"name": "g_minDistanceForSelect", "type": "Number", "purpose": "Squared pixel distance threshold for selecting a point on the histogram."},
    {"name": "g_minTouchDistance", "type": "Number", "purpose": "Larger threshold for touch interfaces."},
    {"name": "g_isTouchInterface", "type": "Boolean", "purpose": "Flag indicating if running on a touch device."},
    {"name": "upperLimitX", "type": "Number", "purpose": "Appears related to Fisher's Exact Test calculations (smallerpvalue), potentially unused or vestigial."},
    {"name": "lowerLimitX", "type": "Number", "purpose": "Appears related to Fisher's Exact Test calculations (smallerpvalue), potentially unused or vestigial."}
  ],
  "functions": [
    {"name": "bc$", "purpose": "Shortcut for document.getElementById(id).", "location": "Inline Script"},
    {"name": "onChangeSelectData", "purpose": "Handles selection change in the sample data dropdown.", "location": "Inline Script", "triggers": "retrieveData", "updatesDOM": "#btnUseTable style"},
    {"name": "retrieveData", "purpose": "Uses jQuery AJAX to fetch data from a URL and populate the dataText textarea.", "location": "Inline Script"},
    {"name": "getInternetExplorerVersion", "purpose": "Detects IE version (used for browser compatibility).", "location": "Inline Script"},
    {"name": "checkBrowser", "purpose": "Checks for basic canvas support and alerts user if missing.", "location": "Inline Script"},
    {"name": "gup", "purpose": "Gets URL parameter values.", "location": "Inline Script"},
    {"name": "pageSetup", "purpose": "Initializes the applet on body load. Sets up plots, event listeners, default data, text based on language.", "location": "Inline Script", "triggers": "checkBrowser, plotSetup, setPageLastModified, useData, textSetup", "event": "body.onload"},
    {"name": "textSetup", "purpose": "Sets UI text elements based on the selected language (g_language) using t_... arrays.", "location": "Inline Script", "triggers": "redraw"},
    {"name": "getMouseDownCanvasXY", "purpose": "Calculates mouse/touch coordinates relative to a canvas element.", "location": "Inline Script"},
    {"name": "getMouseDownChartXY", "purpose": "Converts canvas coordinates to chart data coordinates.", "location": "Inline Script"},
    {"name": "getClosestShuffleStatsIndex", "purpose": "Finds the index of the simulation sample closest to a click on the histogram.", "location": "Inline Script"},
    {"name": "onMouseDown", "purpose": "Handles mousedown/touchstart events, primarily for selecting points/lines on the histogram.", "location": "Inline Script", "event": "document.onmousedown/ontouchstart"},
    {"name": "onMouseMove", "purpose": "Handles mousemove/touchmove events, for dragging the threshold line on the histogram.", "location": "Inline Script", "event": "document.onmousemove/ontouchmove (dynamically attached)"},
    {"name": "onMouseUp", "purpose": "Handles mouseup/touchend events, stopping drag operations.", "location": "Inline Script", "event": "document.onmouseup/ontouchend"},
    {"name": "plotSetup", "purpose": "Initializes a canvas element for plotting (gets context, sets dimensions).", "location": "Inline Script"},
    {"name": "LogGamma", "purpose": "Computes the logarithm of the Gamma function (used for Chi-squared CDF).", "location": "Inline Script"},
    {"name": "Gcf", "purpose": "Continued fraction part of the incomplete Gamma function calculation.", "location": "Inline Script"},
    {"name": "Gser", "purpose": "Series expansion part of the incomplete Gamma function calculation.", "location": "Inline Script"},
    {"name": "Gammacdf", "purpose": "Computes the incomplete Gamma function (used for Chi-squared CDF).", "location": "Inline Script"},
    {"name": "getChiDensity", "purpose": "Estimates the probability density function (PDF) for a Chi-squared distribution.", "location": "Inline Script"},
    {"name": "getchisqCDF", "purpose": "Computes the cumulative distribution function (CDF) for a Chi-squared distribution.", "location": "Inline Script"},
    {"name": "smallerpvalue", "purpose": "Calculates a two-sided p-value for Fisher's Exact Test using hypergeometric distribution. May be vestigial or used indirectly.", "location": "Inline Script"},
    {"name": "getObsStats", "purpose": "Calculates statistics (counts, proportions, Chi-squared, MAD, Max-Min, etc.) for a given dataset represented by shuffleIndex.", "location": "Inline Script"},
    {"name": "getShuffleStats", "purpose": "Calculates summary statistics (mean, SD, min, max, histogram bins) for the collected simulation statistics (g_shuffleStats).", "location": "Inline Script"},
    {"name": "toCanvasY", "purpose": "Converts chart Y data coordinate to canvas Y pixel coordinate.", "location": "Inline Script"},
    {"name": "toChartY", "purpose": "Converts canvas Y pixel coordinate to chart Y data coordinate.", "location": "Inline Script"},
    {"name": "toCanvasX", "purpose": "Converts chart X data coordinate to canvas X pixel coordinate.", "location": "Inline Script"},
    {"name": "toChartX", "purpose": "Converts canvas X pixel coordinate to chart X data coordinate.", "location": "Inline Script"},
    {"name": "setPageLastModified", "purpose": "Displays the document's last modified date in the footer.", "location": "Inline Script"},
    {"name": "shufflePlotSetup", "purpose": "Sets up the axes, labels, and scales for the sample data plots (g_shufflePlot, g_simSamplePlot).", "location": "Inline Script"},
    {"name": "histogramSetup", "purpose": "Sets up the axes, labels, and scales for the histogram plot (g_histogram).", "location": "Inline Script"},
    {"name": "writeHistogramXAxisLabels", "purpose": "Draws numeric labels on the histogram's X-axis.", "location": "Inline Script"},
    {"name": "getBetweenLabels", "purpose": "Calculates 'nice' increments for axis labels.", "location": "Inline Script"},
    {"name": "setSamplePlotMinMax", "purpose": "Sets the min/max data ranges for the sample data plots.", "location": "Inline Script"},
    {"name": "getArrayStats", "purpose": "General utility function to compute statistics (min, max, mean, SD, histogram) for an array.", "location": "Inline Script"},
    {"name": "getMedian", "purpose": "Calculates the median of a numeric array.", "location": "Inline Script"},
    {"name": "setHistogramMinMax", "purpose": "Sets the min/max data ranges for the histogram plot based on simulation results.", "location": "Inline Script"},
    {"name": "setDensityPlotMinMax", "purpose": "Sets the min/max data ranges for the theoretical density plot.", "location": "Inline Script"},
    {"name": "setPlotScale", "purpose": "Calculates the scaling factors (data units to pixels) for a plot.", "location": "Inline Script"},
    {"name": "drawAxes", "purpose": "Draws the X and Y axes lines on a canvas plot.", "location": "Inline Script"},
    {"name": "writeXAxisTitle", "purpose": "Draws the X-axis title on a canvas plot.", "location": "Inline Script"},
    {"name": "writeYAxisTitle", "purpose": "Draws the (rotated) Y-axis title on a canvas plot.", "location": "Inline Script"},
    {"name": "writeXAxisLabels", "purpose": "Draws labels along the X-axis.", "location": "Inline Script"},
    {"name": "stdPlotXLabelFct", "purpose": "Default function to format numeric X-axis labels.", "location": "Inline Script"},
    {"name": "chiPlotXLabelFct", "purpose": "Function to format categorical X-axis labels using g_level names.", "location": "Inline Script"},
    {"name": "writeYAxisLabels", "purpose": "Draws labels along the Y-axis.", "location": "Inline Script"},
    {"name": "stdPlotYLabelFct", "purpose": "Default function to format numeric Y-axis labels.", "location": "Inline Script"},
    {"name": "chiPlotYLabelFct", "purpose": "Function to format percentage Y-axis labels (0-100).", "location": "Inline Script"},
    {"name": "writeUpperLeftText", "purpose": "Utility to write text in the upper-left corner of a plot.", "location": "Inline Script"},
    {"name": "writeUpperRightText", "purpose": "Utility to write text in the upper-right corner of a plot.", "location": "Inline Script"},
    {"name": "drawSamplePlot", "purpose": "Draws the bar chart for observed or sampled data on the specified plot canvas.", "location": "Inline Script"},
    {"name": "getZ", "purpose": "Appears related to t-test calculation (degrees of freedom). May be vestigial or unused.", "location": "Inline Script"},
    {"name": "drawDensityPlot", "purpose": "Draws a theoretical Chi-squared density curve on the densityPlot canvas.", "location": "Inline Script"},
    {"name": "drawHistogram", "purpose": "Draws the histogram of simulation statistics, handles point highlighting, counting, and overlaying theoretical curves.", "location": "Inline Script"},
    {"name": "getHistFillStyle", "purpose": "Determines the fill color for histogram bars based on whether counting is active and the bar meets the criteria.", "location": "Inline Script"},
    {"name": "resetSamplePlot", "purpose": "Clears and redraws the axes/labels for a sample data plot.", "location": "Inline Script"},
    {"name": "resetDensityPlot", "purpose": "Clears the density plot canvas.", "location": "Inline Script"},
    {"name": "resetHistogram", "purpose": "Clears and redraws the axes/labels for the histogram plot.", "location": "Inline Script"},
    {"name": "revertData", "purpose": "Restores the dataText area to the last used data (g_lastUseDataText).", "location": "Inline Script"},
    {"name": "swapInputOrder", "purpose": "Toggles the assumption about input column order (unused for one-way).", "location": "Inline Script"},
    {"name": "getAltProb", "purpose": "Parses and validates the alternative probability input.", "location": "Inline Script"},
    {"name": "getHypothProb", "purpose": "Parses and validates the hypothesized (null) probability input.", "location": "Inline Script"},
    {"name": "plotPiechart1", "purpose": "Uses Plotly to draw a small pie chart of the hypothesized probabilities.", "location": "Inline Script"},
    {"name": "useDataBtn", "purpose": "Wrapper for useData, ensuring g_tableEntry is false.", "location": "Inline Script", "event": "#btnUseData.onclick"},
    {"name": "useData", "purpose": "Parses raw data from dataText, updates internal data structures (g_obsX, g_level, g_numObs), and triggers UI update.", "location": "Inline Script"},
    {"name": "myParseInt", "purpose": "Wrapper for parseInt that handles NaNs and commas.", "location": "Inline Script"},
    {"name": "useTable", "purpose": "Parses data entered as a frequency table from dataText, updates internal structures, updates dataText with raw format, and calls useData.", "location": "Inline Script", "event": "#btnUseTable.onclick"},
    {"name": "doPostUseTasks", "purpose": "Common tasks performed after data is processed by useData or useTable (resetting simulation, setting up plot labels, updating hypothesis inputs, redraw).", "location": "Inline Script"},
    {"name": "getExplanatoryLevel", "purpose": "Finds or adds a category name to the g_level array and returns its index.", "location": "Inline Script"},
    {"name": "getResponseOutcome", "purpose": "Finds or adds a response name to the g_outcome array (unused for one-way).", "location": "Inline Script"},
    {"name": "updateDataText", "purpose": "Updates the dataText textarea to show the current data in raw format.", "location": "Inline Script"},
    {"name": "updateHypProb", "purpose": "Updates the hypProbText textarea based on g_propValues.", "location": "Inline Script"},
    {"name": "updateAltProb", "purpose": "Updates the altProbText textarea based on g_altValues.", "location": "Inline Script"},
    {"name": "updateShuffledStatsText", "purpose": "Intended to update a text area with shuffled stats (unused/incomplete).", "location": "Inline Script"},
    {"name": "updateChisqOutput", "purpose": "Generates and displays the Chi-squared output table (Observed, Expected, Contributions, p-value).", "location": "Inline Script"},
    {"name": "updateTableText", "purpose": "Generates and displays the frequency table (Outcome, Count, Proportion).", "location": "Inline Script"},
    {"name": "updateShuffledDataText", "purpose": "Updates the display area for the most recent shuffled data (table format).", "location": "Inline Script"},
    {"name": "shuffleData", "purpose": "Performs the simulation: generates one or more samples based on hypothesized probabilities, calculates statistics for each, stores results in g_shuffleStats, and triggers animation or redraw.", "location": "Inline Script", "event": "#ShuffleButton.onclick"},
    {"name": "animateShuffle", "purpose": "Starts the card shuffling animation.", "location": "Inline Script"},
    {"name": "drawFullDeck", "purpose": "Draws a representation of the data as cards (unused in current flow).", "location": "Inline Script"},
    {"name": "animateShuffleCycleOut", "purpose": "Handles the 'cards moving out' phase of the animation.", "location": "Inline Script"},
    {"name": "animateShuffleCycleIn", "purpose": "Handles the 'cards moving in' phase of the animation.", "location": "Inline Script"},
    {"name": "drawCards", "purpose": "Draws cards at specific positions during animation.", "location": "Inline Script"},
    {"name": "drawCard", "purpose": "Draws a single rounded-rectangle card.", "location": "Inline Script"},
    {"name": "roundRect", "purpose": "Helper function to draw rounded rectangles (with fallback for IE).", "location": "Inline Script"},
    {"name": "clearCanvas", "purpose": "Clears a canvas element.", "location": "Inline Script"},
    {"name": "changeIs2x2Input", "purpose": "Handles change for 2x2 input mode (unused for one-way).", "location": "Inline Script"},
    {"name": "changeShowShuffleOptions", "purpose": "Handles checkbox change for showing/hiding simulation options. Resets simulation if options are hidden.", "location": "Inline Script", "event": "#showShuffleOptions.onclick"},
    {"name": "changeHypothesized", "purpose": "Handles changes to hypothesized probabilities input. Resets simulation.", "location": "Inline Script", "event": "#hypProbText.onchange"},
    {"name": "changeShowChisq", "purpose": "Handles checkbox change for showing Chi-squared output.", "location": "Inline Script", "event": "#showChisq.onclick"},
    {"name": "changeShowFET", "purpose": "Handles change related to Fisher's Exact Test (unused).", "location": "Inline Script"},
    {"name": "changeShowTable", "purpose": "Handles checkbox change for showing the data table.", "location": "Inline Script", "event": "#showTable.onclick"},
    {"name": "changeShowSimTable", "purpose": "Handles checkbox change for showing the shuffled data table (likely intended, but linked to #shuffleShowTable radio).", "location": "Inline Script"},
    {"name": "changeHistStat", "purpose": "Handles selection change for the primary statistic dropdown. Clears count input.", "location": "Inline Script", "event": "#scenario.onchange"},
    {"name": "changeHistStat2", "purpose": "Handles selection change for the secondary statistic dropdown (mirrors primary).", "location": "Inline Script", "event": "#scenario2.onchange"},
    {"name": "doCountSamples", "purpose": "Sets flag and triggers redraw when count input is changed or button clicked.", "location": "Inline Script", "event": "#countInput.onchange, #t_countButton.onclick"},
    {"name": "normcdf", "purpose": "Approximation for the standard normal CDF.", "location": "Inline Script"},
    {"name": "hyp", "purpose": "Helper function for hypergeometric CDF calculation.", "location": "Inline Script"},
    {"name": "hypercdf", "purpose": "Computes the hypergeometric CDF (used for Fisher's Exact Test).", "location": "Inline Script"},
    {"name": "redraw", "purpose": "Master function to update all UI elements (plots, tables, statistics) based on the current state.", "location": "Inline Script"},
    {"name": "is2by2", "purpose": "Checks if the data represents a 2x2 table (unused for one-way).", "location": "Inline Script"},
    {"name": "selectShowDiff", "purpose": "Selects 'Difference in proportions' statistic (unused for one-way).", "location": "Inline Script"},
    {"name": "selectMeanAbsDiff", "purpose": "Selects 'MAD' statistic.", "location": "Inline Script"},
    {"name": "showDiff", "purpose": "Checks if 'Difference in proportions' is selected (unused for one-way).", "location": "Inline Script"},
    {"name": "showRR", "purpose": "Checks if 'Relative Risk' is selected (unused for one-way).", "location": "Inline Script"},
    {"name": "showMeanAbsDiff", "purpose": "Checks if 'MAD' is selected.", "location": "Inline Script"},
    {"name": "showMM", "purpose": "Checks if 'Max - Min' is selected.", "location": "Inline Script"},
    {"name": "showMaxTally", "purpose": "Checks if 'Max Tally' is selected.", "location": "Inline Script"},
    {"name": "showProportion", "purpose": "Checks if 'Proportion' (first category) is selected.", "location": "Inline Script"},
    {"name": "showMinTally", "purpose": "Checks if 'Min Tally' is selected.", "location": "Inline Script"},
    {"name": "showChiSquared", "purpose": "Checks if 'Chi-squared' is selected.", "location": "Inline Script"},
    {"name": "showXcount", "purpose": "Checks if 'Cell 1 Count' is selected (unused for one-way).", "location": "Inline Script"},
    {"name": "getHistStat", "purpose": "Returns the value of the currently selected statistic from a stats object.", "location": "Inline Script"},
    {"name": "getHistStatChoice", "purpose": "Returns the string key ('MAD', 'CHISQ', etc.) for the currently selected statistic.", "location": "Inline Script"},
    {"name": "clearData", "purpose": "Clears the dataText textarea.", "location": "Inline Script", "event": "#btnClearData.onclick"},
    {"name": "change2x2Input", "purpose": "Updates totals for 2x2 table input (unused for one-way).", "location": "Inline Script"},
    {"name": "about", "purpose": "Displays the 'about' information using showAlert.", "location": "Inline Script"},
    {"name": "changeNotes", "purpose": "Toggles the visibility of the user notes section.", "location": "Inline Script", "event": "#UserNotes.onclick"}
  ],
  "eventHandling": [
    {"event": "body.onload", "handler": "pageSetup", "description": "Initializes the entire application when the page finishes loading."},
    {"element": "#selectData", "event": "onchange", "handler": "onChangeSelectData", "description": "Loads selected sample data."},
    {"element": "#dataText", "event": "onpaste", "handler": "Inline JS", "description": "Handles paste event to work around Chrome spellcheck bug."},
    {"element": "#btnUseData", "event": "onclick", "handler": "useDataBtn", "description": "Processes pasted raw data."},
    {"element": "#btnUseTable", "event": "onclick", "handler": "useTable", "description": "Processes pasted table data."},
    {"element": "#btnClearData", "event": "onclick", "handler": "clearData", "description": "Clears the data input area."},
    {"element": "#hypProbText", "event": "onchange", "handler": "changeHypothesized", "description": "Updates state when hypothesized probabilities are changed."},
    {"element": "#setProbs", "event": "onclick", "handler": "redraw", "description": "Triggers redraw after setting probabilities (though onchange usually handles it)."},
    {"element": "#showAltShuffleOptions", "event": "onclick", "handler": "changeShowShuffleOptions", "description": "Toggles alternative probability input."},
    {"element": "#showShuffleOptions", "event": "onclick", "handler": "changeShowShuffleOptions", "description": "Toggles visibility of simulation controls."},
    {"element": "#altProbText", "event": "onchange", "handler": "changeShowShuffleOptions", "description": "Updates state when alternative probabilities are changed (indirectly via changeShowShuffleOptions)."},
    {"element": "#ShuffleButton", "event": "onclick", "handler": "shuffleData", "description": "Initiates the sampling/simulation process."},
    {"element": "#shuffleShowCards", "event": "onclick", "handler": "redraw", "description": "Selects card animation view for last sample."},
    {"element": "#shuffleShowTable", "event": "onclick", "handler": "redraw", "description": "Selects table view for last sample."},
    {"element": "#shuffleShowPlot", "event": "onclick", "handler": "redraw", "description": "Selects plot view for last sample."},
    {"element": "#scenario2", "event": "onchange", "handler": "changeHistStat2", "description": "Changes the selected statistic for histogram (secondary dropdown)."},
    {"element": "#showGhost", "event": "onclick", "handler": "redraw", "description": "Toggles display of previous simulation histogram."},
    {"element": "#countOperator", "event": "onchange", "handler": "redraw", "description": "Changes the operator for counting samples."},
    {"element": "#countInput", "event": "onchange", "handler": "doCountSamples", "description": "Sets threshold and enables counting."},
    {"element": "#t_countButton", "event": "onclick", "handler": "doCountSamples", "description": "Triggers counting based on input value."},
    {"element": "#overlayF", "event": "onclick", "handler": "redraw", "description": "Toggles overlay of theoretical Chi-squared curve on histogram."},
    {"element": "#overlayZ", "event": "onclick", "handler": "redraw", "description": "Toggles overlay of theoretical Normal curve on histogram."},
    {"element": "#showTable", "event": "onclick", "handler": "changeShowTable", "description": "Toggles visibility of the observed data table."},
    {"element": "#scenario", "event": "onchange", "handler": "changeHistStat", "description": "Changes the selected statistic (primary dropdown)."},
    {"element": "#showChisq", "event": "onclick", "handler": "changeShowChisq", "description": "Toggles visibility of Chi-squared output details."},
    {"element": "#computeCIs", "event": "onclick", "handler": "redraw", "description": "Toggles display of confidence intervals (if applicable)."},
    {"element": "#UserNotes", "event": "onclick", "handler": "changeNotes", "description": "Toggles visibility of user notes."},
    {"element": "document", "event": "onmousedown/ontouchstart", "handler": "onMouseDown", "description": "Detects clicks/touches, primarily for histogram interaction."},
    {"element": "document", "event": "onmousemove/ontouchmove", "handler": "onMouseMove", "description": "Tracks dragging on histogram (dynamically attached)."},
    {"element": "document", "event": "onmouseup/ontouchend", "handler": "onMouseUp", "description": "Ends drag operations on histogram."}
  ],
  "plotting": {
    "canvases": [
      {"id": "shufflePlot", "purpose": "Bar chart of observed data distribution.", "library": "Canvas API", "configVar": "g_shufflePlot"},
      {"id": "simSamplePlot", "purpose": "Bar chart of the most recent simulation sample distribution.", "library": "Canvas API", "configVar": "g_simSamplePlot"},
      {"id": "histogram", "purpose": "Histogram of statistics from multiple simulation samples.", "library": "Canvas API", "configVar": "g_histogram"},
      {"id": "densityPlot", "purpose": "Theoretical Chi-squared probability density curve.", "library": "Canvas API", "configVar": "g_densityPlot"},
      {"id": "simCardAnimation", "purpose": "Animation visualizing the shuffling process (optional).", "library": "Canvas API"}
    ],
    "otherPlots": [
      {"id": "pieDiv", "purpose": "Small pie chart of hypothesized probabilities.", "library": "Plotly.js"}
    ],
    "drawingFunctions": [
      "drawSamplePlot",
      "drawHistogram",
      "drawDensityPlot",
      "plotPiechart1",
      "animateShuffle",
      "drawAxes",
      "writeXAxisTitle",
      "writeYAxisTitle",
      "writeXAxisLabels",
      "writeYAxisLabels"
    ],
    "coordinateSystem": "Uses helper functions (toCanvasX/Y, toChartX/Y) to map between data coordinates and canvas pixel coordinates, accounting for borders."
  },
  "statistics": {
    "calculatedIn": "getObsStats",
    "primaryStatistics": [
      {"name": "Chi-squared (χ²)", "calculation": "Sum of (Observed - Expected)² / Expected", "variable": "stats.chiSquared"},
      {"name": "Mean Absolute Deviation (MAD)", "calculation": "Mean of |Observed - Expected|", "variable": "stats.meanAbsDiff"},
      {"name": "Max - Min", "calculation": "Difference between largest and smallest category proportions", "variable": "stats.MM"},
      {"name": "Max Tally", "calculation": "Maximum observed count in any category", "variable": "stats.maxTally"},
      {"name": "Min Tally", "calculation": "Minimum observed count in any category", "variable": "stats.minTally"},
      {"name": "Proportion (First Category)", "calculation": "Proportion of observations in the first category", "variable": "stats.propA"}
    ],
    "simulation": {
      "method": "Random sampling with replacement based on hypothesized probabilities (g_propValues or g_altValues). Each sample has the same size as the original data (g_numObs).",
      "storage": "Results stored in g_shuffleStats array.",
      "visualization": "Histogram plot ('histogram' canvas)."
    },
    "theoreticalDistributions": [
      {"name": "Chi-squared", "use": "Overlay on histogram (if χ² statistic selected), p-value calculation, density plot.", "functions": ["getchisqCDF", "getChiDensity"]},
      {"name": "Normal", "use": "Overlay on histogram (if difference-based statistic selected, though not primary for one-way).", "functions": ["normcdf"]}
    ]
  },
  "quirksAndNotes": [
    "Uses `bc$(id)` as a shorthand for `document.getElementById(id)`.",
    "Includes functions related to Fisher's Exact Test (`hypercdf`, `smallerpvalue`) which seem unused in the main Chi-squared/simulation workflow for one-way tables.",
    "Includes functions/variables for 2x2 tables (`is2by2`, `change2x2Input`, difference/RR stats) which are largely disabled or unused in the one-way context.",
    "Handles browser differences (IE version check, `g_usingExCanvas` check within `roundRect`).",
    "Includes a workaround (`onpaste`) for a perceived Chrome spellcheck performance issue in textareas.",
    "Uses manual calculations for statistical CDFs (Gamma, Chi-squared, Normal) rather than relying solely on external libraries (except Plotly for the pie chart).",
    "Animation logic (`animateShuffle...`) uses `setTimeout` and a counter (`g_animationCount`) to manage potentially overlapping calls.",
    "Internationalization is supported via `g_language` and `t_...` string arrays.",
    "URL parameters (`gup` function) can potentially hide UI elements (`hideExtras`). Power simulation (`power=1`) might enable alternative hypothesis input.",
    "The 'Show Previous' histogram feature (`g_savedGetShuffleStats`) allows comparing current simulation results to the previous run before the last reset.",
    "Error handling seems basic, relying on `showAlert`.",
    "Table input (`useTable`) preserves category order and allows zero counts, converting the table into raw data format internally and in the `dataText` area."
  ]
}